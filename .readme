# Allâ€‘inâ€‘One YOLO Training Pipeline (v8 â†’ v12)

This project provides a **single, unified, CLIâ€‘based training / evaluation / inference pipeline** that supports **multiple YOLO generations** using the **Ultralytics framework**, while preserving the **structure and behavior of your existing YOLOv8 codebase**.

Supported YOLO versions:

* âœ… YOLOv8
* âœ… YOLOv9
* âœ… YOLOv10
* âš ï¸ YOLOv11 (experimental / depends on Ultralytics release)
* âš ï¸ YOLOv12 (futureâ€‘proof placeholder)

The goal is:

> **Switch YOLO versions without touching the core pipeline logic** â€” only via CLI arguments.

---

## ğŸ”§ Key Design Principles

* **Single codebase** for all YOLO versions
* **CLIâ€‘controlled behavior** (no hardâ€‘coded model logic)
* **Training, validation, testing, inference, and visualization** included
* **Compatible with your current YOLOv8 workflow**
* **Explicit separation of:**

  * Training
  * Validation
  * Test evaluation
  * Qualitative inference

---

## ğŸ“¦ Project Features

### Training

* Detection and classification tasks
* Supports `.pt` **and** `.yaml` model initialization
* Automatic validation after each epoch

### Evaluation

* Validation (`split=val`)
* Test evaluation (`split=test`)
* Metrics saved to JSON

### Visualization

* Training curves from `results.csv`
* Overlay of **groundâ€‘truth vs predictions** (detection only)

### Inference

* Folderâ€‘based inference
* Saves images + YOLOâ€‘format labels
* Optional confidence thresholding

---

## ğŸ§  YOLO Version Handling Logic

This pipeline **does not hardâ€‘code YOLO versions**.

Instead, the YOLO version is inferred from:

* `--weights` (e.g. `yolov8n.pt`, `yolov9c.yaml`, `yolov10n.pt`)

Ultralytics automatically selects the correct architecture internally.

### âœ” Examples

```bash
--weights yolov8n.pt
--weights yolov9c.yaml
--weights yolov10n.pt
```

No code changes required.

---

## ğŸ–¥ï¸ System Requirements

### Hardware

* NVIDIA GPU (recommended)
* CUDAâ€‘enabled system

### Software

| Dependency  | Version                       |
| ----------- | ----------------------------- |
| Python      | â‰¥ 3.9                         |
| PyTorch     | â‰¥ 2.0                         |
| Ultralytics | Latest                        |
| TensorFlow  | Optional (GPU memory control) |

---

## ğŸ“¥ Installation

### 1ï¸âƒ£ Create Environment

```bash
conda create -n yolo_all python=3.10 -y
conda activate yolo_all
```

### 2ï¸âƒ£ Install Dependencies

```bash
pip install ultralytics opencv-python matplotlib seaborn scikit-learn pandas tensorflow
```

Verify installation:

```bash
yolo checks
```

---

## ğŸ“ Dataset Structure

Your `data.yaml` must follow standard YOLO format:

```yaml
path: /dataset/root
train: images/train
val: images/val
test: images/test

names:
  0: class_0
  1: class_1
```

### Important Clarification

* **Validation set** â†’ Used during training (has annotations)
* **Test set** â†’ Used for final unbiased evaluation (has annotations)

YOLO requires labels for **both** val and test splits.

---

## ğŸš€ Running the Pipeline

### Basic Training (YOLOv8)

```bash
python main.py \
  --task detect \
  --data /path/to/data.yaml \
  --weights yolov8n.pt
```

### Training YOLOv9

```bash
python main.py \
  --task detect \
  --data /path/to/data.yaml \
  --weights yolov9c.yaml
```

### Training YOLOv10

```bash
python main.py \
  --task detect \
  --data /path/to/data.yaml \
  --weights yolov10n.pt
```

---

## âš™ï¸ CLI Arguments

| Argument        | Description               |
| --------------- | ------------------------- |
| `--task`        | detect / classify         |
| `--data`        | Path to data.yaml         |
| `--weights`     | YOLO model (.pt or .yaml) |
| `--epochs`      | Training epochs           |
| `--imgsz`       | Image size                |
| `--batch`       | Batch size                |
| `--lr0`         | Learning rate             |
| `--optimizer`   | Optimizer name            |
| `--device`      | cuda / cpu                |
| `--output-dir`  | Output root               |
| `--test-images` | Folder for inference      |
| `--conf`        | Confidence threshold      |

---

## ğŸ“Š Output Directory Structure

```text
runs/exp/
â””â”€â”€ single_run/
    â”œâ”€â”€ weights/
    â”‚   â”œâ”€â”€ best.pt
    â”‚   â””â”€â”€ last.pt
    â”œâ”€â”€ results.csv
    â”œâ”€â”€ metrics.json
    â”œâ”€â”€ training_curves.png
    â”œâ”€â”€ val/
    â”œâ”€â”€ test/
    â”œâ”€â”€ inference/
    â”‚   â”œâ”€â”€ images/
    â”‚   â””â”€â”€ labels/
    â””â”€â”€ overlay/
```

---

## ğŸ§ª Validation vs Test (Important)

| Split    | When            | Purpose                          |
| -------- | --------------- | -------------------------------- |
| **val**  | During training | Model selection / early stopping |
| **test** | After training  | Final reporting only             |

Your pipeline **explicitly separates** these using:

```python
model.val(split="val")
model.val(split="test")
```

---

## ğŸ–¼ï¸ Overlay Visualization (Detection)

* Green boxes â†’ Ground truth
* Red boxes â†’ Predictions

Generated automatically if:

```bash
--test-images /path/to/images
```

Saved under:

```text
runs/exp/single_run/overlay/
```

---

## âš ï¸ Notes on YOLOv11 & v12

* YOLOv11 / v12 support depends on **future Ultralytics releases**
* This pipeline is **forwardâ€‘compatible**
* No code change required once Ultralytics adds support

---

## ğŸ§© What Was Added vs Your Original Code

### âœ… Added

* CLI argument parser
* YOLO version abstraction
* Unified entryâ€‘point (`main.py`)

### âŒ Not Removed

* Training logic
* Validation logic
* Test evaluation
* Overlay visualization
* Metric logging

Your **core logic remains intact**.

---

## ğŸ“Œ Recommended Usage

* Research experiments
* Multiâ€‘YOLO benchmarking
* Medical imaging pipelines
* Reproducible training workflows

---

## ğŸ™Œ Credits

* Ultralytics YOLO
* PyTorch
* OpenCV

---

## ğŸ“¬ Questions / Extensions

This pipeline is designed to scale to:

* kâ€‘fold crossâ€‘validation
* multiâ€‘GPU training
* experiment tracking
* ensemble inference

You can extend it without refactoring the core.

Happy training ğŸš€
